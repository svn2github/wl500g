diff -urBp iptables.orig/include/linux/netfilter/nf_conntrack_tuple.h iptables/include/linux/netfilter/nf_conntrack_tuple.h
--- iptables.orig/include/linux/netfilter/nf_conntrack_tuple.h	2007-04-30 03:03:09.000000000 +0400
+++ iptables/include/linux/netfilter/nf_conntrack_tuple.h	2009-08-18 12:36:12.000000000 +0400
@@ -35,7 +35,7 @@ union nf_conntrack_address {
 union nf_conntrack_man_proto
 {
 	/* Add other protocols here. */
-	u_int16_t all;
+	u_int32_t all;
 
 	struct {
 		__be16 port;
@@ -50,7 +50,7 @@ union nf_conntrack_man_proto
 		__be16 port;
 	} sctp;
 	struct {
-		__be16 key;	/* GRE key is 32bit, PPtP only uses 16bit */
+		__be32 key;	/* GRE key is 32bit, PPtP only uses 16bit */
 	} gre;
 };
 
@@ -73,7 +73,7 @@ struct nf_conntrack_tuple
 		union nf_conntrack_address u3;
 		union {
 			/* Add other protocols here. */
-			u_int16_t all;
+			u_int32_t all;
 
 			struct {
 				__be16 port;
@@ -88,7 +88,7 @@ struct nf_conntrack_tuple
 				__be16 port;
 			} sctp;
 			struct {
-				__be16 key;
+				__be32 key;
 			} gre;
 		} u;
 
