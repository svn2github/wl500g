diff -urBbwp '-x.*' '-x*.o' linux-N12/arch/mips/mm/init.c linux-2.6/arch/mips/mm/init.c
--- linux-N12/arch/mips/mm/init.c	2009-08-27 07:53:51.000000000 +0400
+++ linux-2.6/arch/mips/mm/init.c	2010-01-26 19:49:29.000000000 +0300
@@ -208,32 +208,6 @@ void kunmap_coherent(void)
 	preempt_check_resched();
 }
 
-void copy_user_highpage(struct page *to, struct page *from,
-	unsigned long vaddr, struct vm_area_struct *vma)
-{
-	void *vfrom, *vto;
-
-	vto = kmap_atomic(to, KM_USER1);
-	if (cpu_has_dc_aliases &&
-	    page_mapped(from) && !Page_dcache_dirty(from)) {
-		vfrom = kmap_coherent(from, vaddr);
-		copy_page(vto, vfrom);
-		kunmap_coherent();
-	} else {
-		vfrom = kmap_atomic(from, KM_USER0);
-		copy_page(vto, vfrom);
-		kunmap_atomic(vfrom, KM_USER0);
-	}
-	if (((vma->vm_flags & VM_EXEC) && !cpu_has_ic_fills_f_dc) ||
-	    pages_do_alias((unsigned long)vto, vaddr & PAGE_MASK))
-		flush_data_cache_page((unsigned long)vto);
-	kunmap_atomic(vto, KM_USER1);
-	/* Make sure this page is cleared on other CPU's too before using it */
-	smp_wmb();
-}
-
-EXPORT_SYMBOL(copy_user_highpage);
-
 void copy_to_user_page(struct vm_area_struct *vma,
 	struct page *page, unsigned long vaddr, void *dst, const void *src,
 	unsigned long len)
diff -urBbwp '-x.*' '-x*.o' linux-N12/include/asm-mips/page.h linux-2.6/include/asm-mips/page.h
--- linux-N12/include/asm-mips/page.h	2009-08-27 07:53:26.000000000 +0400
+++ linux-2.6/include/asm-mips/page.h	2009-10-03 17:58:32.000000000 +0400
@@ -49,6 +49,7 @@
 #define ARCH_PFN_OFFSET		PFN_UP(PHYS_OFFSET)
 
 #include <linux/pfn.h>
+#include <asm/cpu-features.h>
 #include <asm/io.h>
 
 extern void clear_page(void * page);
@@ -74,13 +75,16 @@ static inline void clear_user_page(void
 		flush_data_cache_page((unsigned long)addr);
 }
 
-extern void copy_user_page(void *vto, void *vfrom, unsigned long vaddr,
-	struct page *to);
-struct vm_area_struct;
-extern void copy_user_highpage(struct page *to, struct page *from,
-	unsigned long vaddr, struct vm_area_struct *vma);
+static inline void copy_user_page(void *vto, void *vfrom, unsigned long vaddr,
+	struct page *to)
+{
+	extern void (*flush_data_cache_page)(unsigned long addr);
 
-#define __HAVE_ARCH_COPY_USER_HIGHPAGE
+	copy_page(vto, vfrom);
+	if (!cpu_has_ic_fills_f_dc ||
+	    pages_do_alias((unsigned long)vto, vaddr & PAGE_MASK))
+		flush_data_cache_page((unsigned long)vto);
+}
 
 /*
  * These are used to make use of C type-checking..
