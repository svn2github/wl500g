Wrong Ns in ZLB packets - ID: 2844119
Thomas Surrel ( tsurrel ) - 2009-08-25 09:05
http://sourceforge.net/tracker/?func=detail&aid=2844119&group_id=63352&atid=503661

diff -BurpN gateway/rp-l2tp-0.4/tunnel.c gateway/rp-l2tp/tunnel.c
--- gateway/rp-l2tp-0.4/tunnel.c	2009-09-02 16:44:31.000000000 +0000
+++ gateway/rp-l2tp/tunnel.c	2009-09-02 16:44:47.000000000 +0000
@@ -1298,7 +1298,7 @@ tunnel_send_ZLB(l2tp_tunnel *tunnel)
 	return;
     }
     dgram->Nr = tunnel->Nr;
-    dgram->Ns = tunnel->Ns;
+    dgram->Ns = tunnel->Ns_on_wire;
     l2tp_dgram_send_to_wire(dgram, &tunnel->peer_addr);
     l2tp_dgram_free(dgram);
 }
