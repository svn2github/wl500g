diff -urBp miniupnpd-1.6/Makefile.linux miniupnpd/Makefile.linux
--- miniupnpd-1.6/Makefile.linux	2011-03-09 18:31:00.000000000 +0300
+++ miniupnpd/Makefile.linux	2011-05-19 17:55:42.000000000 +0400
@@ -17,7 +17,7 @@
 # $ IPTABLESPATH=/path/to/iptables-1.4.1 make -f Makefile.linux
 #
 #CFLAGS = -Wall -O -D_GNU_SOURCE -g -DDEBUG
-CFLAGS ?= -Wall -Os -D_GNU_SOURCE -fno-strict-aliasing -Wstrict-prototypes 
+CFLAGS ?= -Wall -Os -D_GNU_SOURCE -fno-strict-aliasing -Wstrict-prototypes $(EXTRACFLAGS)
 CC ?= gcc
 RM = rm -f
 INSTALL = install
@@ -41,15 +41,7 @@
 
 ALLOBJS = $(BASEOBJS) $(LNXOBJS) $(NETFILTEROBJS)
 
-ifeq "$(wildcard /etc/gentoo-release )" ""
 LIBS ?= -liptc
-else
-# the following is better, at least on gentoo with iptables 1.4.6
-#Â see http://miniupnp.tuxfamily.org/forum/viewtopic.php?p=1618
-# and http://miniupnp.tuxfamily.org/forum/viewtopic.php?p=2183
-LIBS ?= -lip4tc
-CFLAGS := -I/usr/src/linux/include -DIPTABLES_143 $(CFLAGS)
-endif
 
 ARCH ?= $(shell uname -m | grep -q "x86_64" && echo 64)
 ifdef IPTABLESPATH
@@ -63,11 +63,6 @@ IPTABLESVERSION3 := $(shell echo $(IPTAB
 TEST := $(shell [ \( \( $(IPTABLESVERSION1) -ge 1 \) -a \( $(IPTABLESVERSION2) -ge 4 \) \) -a \( $(IPTABLESVERSION3) -ge 3 \) ] && echo 1 )
 ifeq ($(TEST), 1)
 CFLAGS := $(CFLAGS) -DIPTABLES_143
-# the following sucks, but works
-LIBS = $(IPTABLESPATH)/libiptc/.libs/libip4tc.o
-#LIBS = $(IPTABLESPATH)/libiptc/.libs/libiptc.a
-else
-LIBS = $(IPTABLESPATH)/libiptc/libiptc.a
 endif
 else
 # check for system-wide iptables files. Test if iptables version >= 1.4.3
@@ -110,7 +109,7 @@
 	sed -i -e "s/^uuid=[-0-9a-f]*/uuid=`($(STAGING_DIR_HOST)/bin/genuuid||$(STAGING_DIR_HOST)/bin/uuidgen) 2>/dev/null`/" miniupnpd.conf
 endif
 
-miniupnpd:	$(BASEOBJS) $(LNXOBJS) $(NETFILTEROBJS) $(LIBS)
+miniupnpd:	$(BASEOBJS) $(LNXOBJS) $(NETFILTEROBJS)
 
 testupnpdescgen:	$(TESTUPNPDESCGENOBJS)
 
