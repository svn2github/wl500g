--- dnsmasq-2.56/src/util.c	2011-01-18 22:23:57.000000000 +0000
+++ dnsmasq-2.57/src/util.c	2011-02-16 09:37:37.000000000 +0000
@@ -379,7 +379,7 @@
   while (maxlen == -1 || i < maxlen)
     {
       for (r = in; *r != 0 && *r != ':' && *r != '-'; r++)
-	if (!isxdigit((int)*r))
+	if (*r != '*' && !isxdigit((unsigned char)*r))
 	  return -1;
       
       if (*r == 0)
