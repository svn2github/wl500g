--- dnsmasq.orig/src/option.c	2012-12-03 20:05:59.000000000 +0600
+++ dnsmasq/src/option.c	2012-12-06 15:53:02.000000000 +0600
@@ -3002,7 +3002,7 @@ static int one_opt(int option, char *arg
     case LOPT_RR: /* dns-rr */
       {
        	struct txt_record *new;
-	size_t len;
+	size_t len = 0;
 	char *data;
 	int val;
 
@@ -3019,12 +3019,11 @@ static int one_opt(int option, char *arg
 	  ret_err(_("bad RR record"));
 	   	
 	new->class = val;
-	new->len = 0;
+	new->len = len;
 	
-	if (data)
+	if (data && len)
 	  {
 	    new->txt=opt_malloc(len);
-	    new->len = len;
 	    memcpy(new->txt, data, len);
 	  }
 	
