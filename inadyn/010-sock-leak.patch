Fix nasty socket leak from http://github.com/troglobit/inadyn/commit/17851b8c5bd33aa3a2ce7a6df8521a977ac5cc69

--- a/src/tcp.c	2010-07-11 03:31:21.000000000 +0400
+++ b/src/tcp.c	2010-10-26 20:31:18.000000000 +0400
@@ -109,8 +109,13 @@ RC_TYPE tcp_initialize(TCP_SOCKET *p_sel
 		else
 		{
 			rc = RC_IP_BAD_PARAMETER;
+			break;
 		}
 
+		/* Allow tcp_shutdown() to run to
+		 * prevent socket leak if any of the below calls fail. */
+		p_self->initialized = TRUE;
+
 		/* set timeouts */
 		setsockopt(p_self->super.socket,SOL_SOCKET,SO_RCVTIMEO,
 				(char*)&p_self->super.timeout,sizeof(p_self->super.timeout));
@@ -132,10 +137,6 @@ RC_TYPE tcp_initialize(TCP_SOCKET *p_sel
 	{
 		tcp_shutdown(p_self);		
 	}
-	else
-	{
-		p_self->initialized = TRUE;
-	}
 			
 	return rc;
 }
-- 
